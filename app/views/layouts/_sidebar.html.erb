<aside class="w-56 bg-base-100 min-h-screen flex flex-col">
  <!-- Logo -->
  <div class="px-5 py-6">
    <a href="<%= root_path %>" class="flex items-center gap-2">
      <span class="text-lg font-semibold tracking-tight">Livecart</span>
    </a>
  </div>
  <!-- Navigation -->
  <nav class="flex-1 px-3">
    <ul class="space-y-1">
      <li>
        <%= link_to root_path, class: "flex items-center gap-3 px-3 py-2 text-sm rounded-lg transition-colors #{current_page?(root_path) ? 'bg-base-200 text-base-content font-medium' : 'text-base-content/70 hover:bg-base-200/50 hover:text-base-content'}" do %>
          <%= lucide_icon('layout-dashboard', class: 'w-4 h-4') %>
          <span>Dashboard</span>
        <% end %>
      </li>
      <li>
        <a href="#" class="flex items-center gap-3 px-3 py-2 text-sm text-base-content/70 rounded-lg hover:bg-base-200/50 hover:text-base-content transition-colors">
          <%= lucide_icon('message-circle', class: 'w-4 h-4') %>
          <span>Chat</span>
        </a>
      </li>
      <li>
        <%= link_to orders_path, class: "flex items-center gap-3 px-3 py-2 text-sm rounded-lg transition-colors #{current_page?(orders_path) || request.path.start_with?('/orders') ? 'bg-base-200 text-base-content font-medium' : 'text-base-content/70 hover:bg-base-200/50 hover:text-base-content'}" do %>
          <%= lucide_icon('shopping-bag', class: 'w-4 h-4') %>
          <span>Zamówienia</span>
        <% end %>
      </li>
      <li>
        <%= link_to transmissions_path, class: "flex items-center gap-3 px-3 py-2 text-sm rounded-lg transition-colors #{current_page?(transmissions_path) || request.path.start_with?('/transmissions') ? 'bg-base-200 text-base-content font-medium' : 'text-base-content/70 hover:bg-base-200/50 hover:text-base-content'}" do %>
          <%= lucide_icon('radio', class: 'w-4 h-4') %>
          <span>Transmisje</span>
        <% end %>
      </li>
      <% products_active = request.path.start_with?('/products') %>
      <li>
        <details class="group" <%= 'open' if products_active %>>
          <summary class="flex items-center gap-3 px-3 py-2 text-sm rounded-lg transition-colors cursor-pointer list-none <%= products_active ? 'bg-base-200 text-base-content font-medium' : 'text-base-content/70 hover:bg-base-200/50 hover:text-base-content' %>">
            <%= lucide_icon('package', class: 'w-4 h-4') %>
            <span class="flex-1">Produkty</span>
            <%= lucide_icon('chevron-down', class: 'w-4 h-4 transition-transform group-open:rotate-180') %>
          </summary>
          <ul class="mt-1 ml-7 space-y-1">
            <li>
              <%= link_to products_path, class: "flex items-center gap-2 px-3 py-2 text-sm rounded-lg transition-colors #{current_page?(products_path) ? 'bg-base-200 text-base-content font-medium' : 'text-base-content/70 hover:bg-base-200/50 hover:text-base-content'}" do %>
                <span>Lista produktów</span>
              <% end %>
            </li>
            <li>
              <%= link_to import_form_products_path, class: "flex items-center gap-2 px-3 py-2 text-sm rounded-lg transition-colors #{current_page?(import_form_products_path) ? 'bg-base-200 text-base-content font-medium' : 'text-base-content/70 hover:bg-base-200/50 hover:text-base-content'}" do %>
                <span>Import</span>
              <% end %>
            </li>
            <li>
              <%= link_to import_history_products_path, class: "flex items-center gap-2 px-3 py-2 text-sm rounded-lg transition-colors #{current_page?(import_history_products_path) ? 'bg-base-200 text-base-content font-medium' : 'text-base-content/70 hover:bg-base-200/50 hover:text-base-content'}" do %>
                <span>Historia importów</span>
              <% end %>
            </li>
          </ul>
        </details>
      </li>
      <li>
        <%= link_to customers_path, class: "flex items-center gap-3 px-3 py-2 text-sm rounded-lg transition-colors #{current_page?(customers_path) || request.path.start_with?('/customers') ? 'bg-base-200 text-base-content font-medium' : 'text-base-content/70 hover:bg-base-200/50 hover:text-base-content'}" do %>
          <%= lucide_icon('users', class: 'w-4 h-4') %>
          <span>Klienci</span>
        <% end %>
      </li>
      <li>
        <%= link_to integrations_path, class: "flex items-center gap-3 px-3 py-2 text-sm rounded-lg transition-colors #{current_page?(integrations_path) || request.path.start_with?('/integrations') ? 'bg-base-200 text-base-content font-medium' : 'text-base-content/70 hover:bg-base-200/50 hover:text-base-content'}" do %>
          <%= lucide_icon('plug', class: 'w-4 h-4') %>
          <span>Integracje</span>
        <% end %>
      </li>
    </ul>
    <div class="my-4 mx-3 border-t border-base-200"></div>
    <ul class="space-y-1">
      <li>
        <%= link_to settings_root_path, class: "flex items-center gap-3 px-3 py-2 text-sm rounded-lg transition-colors #{request.path.start_with?('/settings') ? 'bg-base-200 text-base-content font-medium' : 'text-base-content/70 hover:bg-base-200/50 hover:text-base-content'}" do %>
          <%= lucide_icon('settings', class: 'w-4 h-4') %>
          <span>Ustawienia</span>
        <% end %>
      </li>
    </ul>
  </nav>
  <!-- User section -->
  <% if user_signed_in? %>
    <div class="p-3 mt-auto">
      <div class="dropdown dropdown-top w-full">
        <div tabindex="0" role="button" class="flex items-center gap-3 w-full px-3 py-2 rounded-lg hover:bg-base-200/50 transition-colors cursor-pointer">
          <div class="w-8 h-8 rounded-full bg-base-300 flex items-center justify-center">
            <span class="text-xs font-medium text-base-content/70"><%= current_user.email[0].upcase %></span>
          </div>
          <div class="flex-1 min-w-0">
            <p class="text-sm font-medium truncate"><%= current_user.account&.company_name || 'Mój sklep' %></p>
          </div>
          <%= lucide_icon('chevrons-up-down', class: 'w-4 h-4 text-base-content/40') %>
        </div>
        <ul tabindex="0" class="dropdown-content menu bg-base-100 rounded-lg z-1 w-full p-1 shadow-lg border border-base-200 mb-1">
          <li>
            <%= link_to edit_user_registration_path, class: "flex items-center gap-2 px-3 py-2 text-sm rounded-md" do %>
              <%= lucide_icon('user', class: 'w-4 h-4') %>
              Profil
            <% end %>
          </li>
          <li>
            <%= link_to employees_path, class: "flex items-center gap-3 px-3 py-2 text-sm text-base-content/70 rounded-lg hover:bg-base-200/50 hover:text-base-content transition-colors" do %>
              <%= lucide_icon('user-cog', class: 'w-4 h-4') %>
              <span>Konta pracownicze</span>
            <% end %>
          </li>
          <li>
            <%= button_to destroy_user_session_path, method: :delete, class: "flex items-center gap-2 px-3 py-2 text-sm rounded-md text-error w-full text-left" do %>
              <%= lucide_icon('log-out', class: 'w-4 h-4') %>
              Wyloguj się
            <% end %>
          </li>
        </ul>
      </div>
    </div>
  <% end %>
</aside>
