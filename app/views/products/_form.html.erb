<%= form_with model: @product, local: true, html: { multipart: true } do |f| %>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div class="form-control w-full">
      <%= f.label :name, "Nazwa produktu", class: "label" %>
      <%= f.text_field :name, class: "input input-bordered w-full focus:input-primary", placeholder: "np. Koszulka męska" %>
    </div>
    <div class="form-control w-full">
      <%= f.label :sku, "SKU", class: "label" %>
      <%= f.text_field :sku, class: "input input-bordered w-full focus:input-primary", placeholder: "np. KOSZ-001" %>
    </div>
    <div class="form-control w-full">
      <%= f.label :ean, "EAN", class: "label" %>
      <%= f.text_field :ean, class: "input input-bordered w-full focus:input-primary", placeholder: "np. 5901234123457" %>
    </div>
    <div class="form-control w-full">
      <%= f.label :gross_price, "Cena brutto", class: "label" %>
      <%= f.number_field :gross_price, class: "input input-bordered w-full focus:input-primary", step: 0.01, min: 0, placeholder: "np. 99.99" %>
    </div>
    <div class="form-control w-full">
      <%= f.label :tax_rate, "Stawka VAT", class: "label" %>
      <%= f.select :tax_rate, [["23%", 23], ["8%", 8], ["5%", 5], ["0%", 0]], {}, class: "select select-bordered w-full focus:select-primary" %>
    </div>
    <div class="form-control w-full">
      <%= f.label :quantity, "Ilość", class: "label" %>
      <%= f.number_field :quantity, class: "input input-bordered w-full focus:input-primary", min: 0, placeholder: "np. 100" %>
    </div>
    <div class="form-control w-full">
      <%= f.label :currency, "Waluta", class: "label" %>
      <%= f.select :currency, [["PLN", "PLN"], ["EUR", "EUR"], ["USD", "USD"]], {}, class: "select select-bordered w-full focus:select-primary" %>
    </div>
    <div class="form-control w-full md:col-span-2">
      <%= f.label :images, "Zdjęcia produktu", class: "label" %>
      <% if @product.images.attached? %>
        <p class="text-sm text-gray-500 mb-2">Zaznacz zdjęcia do usunięcia:</p>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-4">
          <% @product.images.each do |image| %>
            <div class="relative group">
              <%= image_tag image, class: "w-full h-32 object-cover rounded-lg border" %>
              <label class="absolute top-2 right-2 flex items-center gap-1 bg-error text-white px-2 py-1 rounded cursor-pointer opacity-80 hover:opacity-100">
                <%= check_box_tag "product[images_to_delete][]", image.id, false, class: "checkbox checkbox-xs" %>
                <span class="text-xs">Usuń</span>
              </label>
            </div>
          <% end %>
        </div>
      <% end %>
      <%= f.file_field :images, multiple: true, accept: "image/png,image/jpeg", class: "file-input file-input-bordered w-full focus:file-input-primary" %>
      <label class="label">
        <span class="label-text-alt text-gray-500">Dodaj nowe zdjęcia. Maksymalnie 5MB. Formaty: PNG, JPEG</span>
      </label>
    </div>
  </div>
  <div class="mt-6">
    <%= f.submit @product.persisted? ? "Zapisz zmiany" : "Dodaj produkt", class: "btn btn-primary" %>
    <%= link_to "Anuluj", products_path, class: "btn btn-ghost" %>
  </div>
<% end %>