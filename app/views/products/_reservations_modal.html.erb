<dialog id="reservations_modal_<%= product.id %>" class="modal">
  <div class="modal-box max-w-4xl">
    <form method="dialog">
      <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">✕</button>
    </form>
    <h3 class="font-bold text-lg mb-4">Rezerwacje - <%= product.name %></h3>
    <% reservations = product.product_reservations.order(created_at: :desc) %>
    <% if reservations.any? %>
      <div class="overflow-x-auto">
        <table class="table table-zebra table-sm">
          <thead>
            <tr>
              <th>Data</th>
              <th>Zamówienie</th>
              <th>Klient</th>
              <th>Ilość</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            <% reservations.each do |reservation| %>
              <tr>
                <td><%= reservation.created_at.strftime("%d.%m.%Y %H:%M") %></td>
                <td>
                  <%= link_to "##{reservation.order.order_number}", order_path(reservation.order), class: "link link-primary" %>
                </td>
                <td>
                  <% if reservation.customer %>
                    <%= reservation.customer.first_name %> <%= reservation.customer.last_name %>
                  <% else %>
                    <span class="text-gray-400">Brak danych</span>
                  <% end %>
                </td>
                <td><%= reservation.quantity %></td>
                <td>
                  <span class="badge badge-<%= reservation.status_badge_class %>"><%= reservation.status_name %></span>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% else %>
      <div class="alert alert-info">
        <%= lucide_icon('info', class: 'w-4 h-4') %>
        <span>Brak rezerwacji dla tego produktu</span>
      </div>
    <% end %>
  </div>
  <form method="dialog" class="modal-backdrop">
    <button>close</button>
  </form>
</dialog>
